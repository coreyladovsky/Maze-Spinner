<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <style media="screen">
      canvas {
      /*border : 5px solid green;*/
    }
    </style>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const canvas = document.querySelector('canvas')
        const ctx = canvas.getContext("2d")
        const draw_reset = () => {

          ctx.font = "50px Arial";
          ctx.fillText("N",330,50);
          ctx.beginPath();
          ctx.arc(350, 350, 290, 0, Math.PI * 2, true)
          ctx.moveTo(110, 110);
          ctx.fillStyle = "yellow"
          ctx.stroke();
          ctx.fill();


          const maze = [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0],
            [0,0,0,1,1,1,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0],
            [0,0,0,1,0,0,0,0,1,0,1,0,1,0,1,0,1,1,0,1,1,1,1,1,0,0,0,0],
            [0,0,0,1,0,1,1,1,1,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0],
            [0,0,0,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,0,0,1,0,1,0,0,0,0],
            [0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,0],
            [0,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0],
            [0,0,1,1,1,0,1,0,1,0,1,0,0,0,0,1,0,0,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,1,0,1,0,1,0,0,0,1,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,0,1,0,0,0,0,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,0,1,0,1,1,1,1,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0],
            [0,0,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0],
            [0,0,0,0,0,1,1,1,1,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
          ]
          for(let y = 0; y < maze.length; y++) {
            for(let x = 0; x < maze[y].length; x++) {
              let tile = maze[y][x]
              if(maze[y][x] === 1) {
                ctx.fillStyle = "black";
                ctx.fillRect(x * 25, y * 25, 25, 25)

                if(trueCollisionCheck(mover.run_x, 7, mover.run_y, y * 25, x * 25, 25)) {
                  backwardsStep()
                }
              }
            }
          }




        }

        const mover = {
          run_x: 70,
          run_y: 337,
          last_x: 70,
          last_y: 337,
          ctx,
          start: function() {
            this.ctx.fillStyle = "blue";
            ctx.beginPath();
            ctx.arc(this.run_x, this.run_y, 7, 0, Math.PI * 2, true)
            ctx.moveTo(110, 110);
            ctx.stroke();
            ctx.fill()
            // this.ctx.fillRect(this.run_x, this.run_y, 10, 10)

          },
          revert: function() {
              this.run_x = this.last_x;
              this.run_y = this.last_y;
              this.ctx.fillStyle = "blue";
              ctx.beginPath();
              ctx.arc(this.run_x, this.run_y, 7, 0, Math.PI * 2, true)
              ctx.moveTo(110, 110);
              ctx.stroke();
              ctx.fill()
            },

        }

        function updateLastX(num) {
          mover.last_x += num
        }

        function updateLastY(num) {
          mover.last_y += num
        }

        function step() {
          ctx.clearRect(0,0, 700, 700)
          draw_reset()
          mover.start()
          requestAnimationFrame(step)
        }

        function backwardsStep() {
          mover.revert()
          ctx.clearRect(0,0, 700, 700)
          draw_reset()
        }

        document.addEventListener("keydown", (e) => {
          switch (e.key) {
            case "ArrowUp":
            if(mover.last_y !== mover.run_y) {
              mover.last_y = mover.run_y
            }
              mover.run_y -= 4
              break;
            case "ArrowDown":
            if(mover.last_y !== mover.run_y) {
              mover.last_y = mover.run_y
            }
              mover.run_y += 4
            break;
            case "ArrowRight":
            if(mover.last_x !== mover.run_x) {
              mover.last_x = mover.run_x
            }
              mover.run_x += 4
            break;
            case "ArrowLeft":
            if(mover.last_x !== mover.run_x) {
              mover.last_x = mover.run_x
            }
              mover.run_x -= 4
              break;
            default:
            console.log("you pushed a different key");
          }
        })
        step()

      })


    </script>

    <canvas id="canvas" width="700" height="700"></canvas>
    <script type="text/javascript" src="collision.js"></script>
  </body>
</html>
